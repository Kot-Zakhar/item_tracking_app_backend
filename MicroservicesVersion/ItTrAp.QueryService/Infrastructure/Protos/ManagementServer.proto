syntax = "proto3";

option csharp_namespace = "ItTrAp.QueryService.Infrastructure.Protos";

package management;

import "google/protobuf/wrappers.proto";

service ManagementServer {
    rpc GetInstanceAmountInLocations(GetInstanceAmountRequest) returns (GetInstanceAmountResponse);
    rpc GetInstanceStatusesByItem(GetInstanceStatusesByItemRequest) returns (GetInstanceStatusesByItemResponse);
    rpc GetUserStatusesForItems(GetUserStatusesForItemsRequest) returns (GetUserStatusesForItemsResponse);
    rpc GetItemAmountsByUserIds(GetItemAmountsByUserIdsRequest) returns (GetItemAmountsByUserIdsResponse);
    rpc GetFilteredMovableInstances(GetFilteredMovableInstancesRequest) returns (GetFilteredMovableInstancesResponse);
}

// ---

message GetInstanceAmountRequest {
    repeated uint32 ids = 1;
}

message GetInstanceAmountResponse {
    repeated uint32 amounts = 1;
}

// ---

message GetInstanceStatusesByItemRequest {
    string itemId = 1;
}

message GetInstanceStatusesByItemResponse {
    repeated MovableInstanceStatus statuses = 1;
}

// ---

message GetUserStatusesForItemsRequest {
    repeated string ids = 1;
}

message GetUserStatusesForItemsResponse {
    repeated UserStatusesForItem userStatusesForItems = 1;
}

// ---

message GetItemAmountsByUserIdsRequest {
    repeated uint32 ids = 1;
}

message GetItemAmountsByUserIdsResponse {
    repeated uint32 amounts = 1;
}

// ---

message UserStatusesForItem {
    string itemId = 1;
    repeated UserStatus userStatuses = 2;
}

message UserStatus {
    uint32 userId = 1;
    uint32 status = 2;
}

message MovableInstanceStatus {
    uint32 id = 1;
    string itemId = 2;
    uint32 status = 3;
    google.protobuf.UInt32Value userId = 4;
    google.protobuf.UInt32Value locationId = 5;
}

// --

message GetFilteredMovableInstancesRequest {
    repeated uint32 userIds = 1;
    repeated uint32 locationIds = 2;
    google.protobuf.UInt32Value status = 3;
}

message GetFilteredMovableInstancesResponse {
    repeated MovableInstanceStatus instances = 1;
}